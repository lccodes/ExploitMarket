package edu.brown.game;

import edu.brown.agent.VerifierAgent;
import edu.brown.assets.Exploit;
import edu.brown.game.worlds.World;
import edu.brown.signals.Verify;

public class Verifier {
	private final World world;
	
	public Verifier(World w) {
		this.world = w;
	}
	
	public Verify verify(VerifierAgent agent, long from, Exploit e) {
		if (!world.contains(from)) {
			return Verify.of(e.NAME, e.FIRMAGENT, e.DANGER, world.getID(agent), false);
		}
		
		if (world.verify(e)) {
			return Verify.of(e.NAME, e.FIRMAGENT, e.DANGER, world.getID(agent), true);
		} else {
			return Verify.of(e.NAME, e.FIRMAGENT, e.DANGER, world.getID(agent), false);
		}
	}
}
